<div class="container">
  <div class="row">
    <div class="col-md-2">
      <%= render 'users/shared/counsel_category' %>
    </div>
    <div class="col-md-6 col-md-offset-2">
      <!-- ユーザについて -->
      <section>
        <div class="media">
          <!-- 退会済みユーザ対応 -->
        <% if @counsel.user_deleted?(@counsel.user) %>
          <%= image_tag "default_user.png", size: "100x100" %>
        <% else %>
          <!-- プロフィール画像 -->
          <% if @counsel.user.avatar.attached? %>
            <%= link_to @counsel.user, class: "media-left" do %>
              <%= image_tag @counsel.user.avatar.variant(resize: "100x100") %>
            <% end %>
          <% else %>
            <%= link_to @counsel.user, class: "media-left" do %>
              <%= image_tag "default_user.png", size: "64x64" %>
            <% end %>
          <% end %>
        <% end %>
        <div class="media-body" >
          <!-- ユーザー情報 -->
          <h3 class="media-heading">
            <h3 class="media-heading">
            <% if @counsel.user_deleted?(@counsel.user) %>
              退会済みの先生
            <% else %>
              <%= link_to user_path(@counsel.user) do %>
                <%= @counsel.user.last_name %> <%= @counsel.user.first_name %>
              <% end %>
            <% end %>
            <!-- フォローボタン -->
            <% unless @counsel.user_deleted?(@counsel.user) %>
              <span id="follow_<%= @counsel.user.id %>"><%= render 'users/shared/follow', user: @counsel.user %></span>
            <% end %>
          </h3>
          <ul class="list-unstyled list-inline">
            <li><%= @counsel.category %></li>
            <li><%= @counsel.created_at.to_s(:datetime) %></li>
          </ul>
        </div>
      </section>
       <!-- 悩み相談について -->
      <section>
        <!-- タイトル -->
        <h2>
          <%= @counsel.title %>
        </h2>

        <!-- 本文 -->
          <p><%= @counsel.description %></p>

        <!-- 編集・削除ボタン -->
        <% if current_user.own_counsel?(@counsel) %>
          <%= link_to edit_counsel_path(@counsel) do %>
            <i class="fas fa-edit"></i> 編集する
          <% end %>
          <%= link_to counsel_path(@counsel), method: :delete, data: {confirm:"本当に削除してもよろしいですか？"} do %>
            <i class="far fa-trash-alt"></i> 削除する
          <% end %>
        <% end %>
      </section>
      <hr>

      <!-- コメント -->
      <section>
        <span>
          <i class="far fa-comments"></i> コメント 全<%= @counsel_comments.count %>件
        </span>
        <!-- コメントフォーム -->
        <div class="form-group">
          <%= form_with model: [@counsel, @counsel_comment], local: true do |f| %>
          <div class="form-group">
            <%= f.text_field :comment, autofocus: true, placeholder: "アドバイスを記入してください", class: "form-control" %>
          </div>
          <div class="action text-right">
            <%= f.submit "投稿", class: "btn btn-sm btn-success" %>
          </div>
          <% end %>
        </div>
        <!-- コメント一覧 -->
        <div>
          <%= render 'users/shared/counsel_comment_index', counsel_comments: @counsel_comments %>
        </div>
      </section>

      <!-- 戻るボタン -->
      <div><%= link_to "戻る", counsels_path %></div>

    </div>
  </div>
</div>